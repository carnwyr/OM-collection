extends layout

block content
	script(src="/javascripts/accountFunctions.js")
	script.
		var username = !{JSON.stringify(user.name)};

	div(id="successAlert" class="alert alert-success" role="alert" style="position: fixed; z-index: 2; right: 20px; display: none; top: -100px") Confirmation message has been sent to your email
	div(id="failAlert" class="alert alert-danger" role="alert" style="position: fixed; z-index: 2; right: 20px; display: none; top: -100px") Something went wrong, please reload the page

	div(class="modal fade" id="emailModal" tabindex="-1" role="dialog" aria-labelledby="bindEmailLabel" aria-hidden="true")
		div(class="modal-dialog" role="document")
			div(class="modal-content")
				div(class="modal-header")
					h5(class="modal-title" id="bindEmailLabel") Link email
					button(type="button" class="close" data-dismiss="modal" aria-label="Close")
						span( aria-hidden="true") &times;
				div(class="modal-body")
					p A confirmation message will be sent to your email. Please open the link in it to verify the email address.
					form
						div(class='form-group')
							label(for="email") Email
							input(class='form-control' type="email" id="email" name="email")
						div(class='form-group')
							label(for="password") Karasu OS password
							input(class='form-control' type="password" id="password" name="password")
				div(class="modal-footer")
					button(type="button" class="btn btn-secondary text-light" id="sendVerification") Send verification message

	div(class="modal fade" id="passwordModal" tabindex="-1" role="dialog" aria-labelledby="changePasswordLabel" aria-hidden="true")
		div(class="modal-dialog" role="document")
			div(class="modal-content")
				div(class="modal-header")
					h5(class="modal-title" id="changePasswordLabel") Change Password
					button(type="button" class="close" data-dismiss="modal" aria-label="Close")
						span( aria-hidden="true") &times;
				div(class="modal-body")
					form
						div(class='form-group')
							label(for="oldPassword") Old password
							input(class='form-control' type="password" id="oldPassword" name="oldPassword")
						div(class='form-group')
							label(for="newPassword") New password
							input(class='form-control' type="password" id="newPassword" name="newPassword")
						div(class='form-group')
							label(for="newPasswordConfirm") Confirm new password
							input(class='form-control' type="password" id="newPasswordConfirm" name="newPasswordConfirm")
				div(class="modal-footer")
					button(type="button" class="btn btn-secondary text-light" id="changePassword") Update password

	div(class="container")
		div(class="row justify-content-center mb-3")
			h2(class="col-lg-10 text-primary text-center py-2" style='border-bottom: 2px solid; border-color: #8d6fe2;') #{user.name}'s Account Settings
			div(class="card rounded shadow col-lg-10")
				div(class="card-body col-lg-6 mx-auto")

					if user.email
						- var emailStatus = user.email
						- var buttonText = "Change email"
						- var emailMsg = "This is the email that will receive instructions for password recovery."
					else
						- var emailStatus = "No emails linked"
						- var buttonText = "Link email"
						- var emailMsg = "To enable password recovery, link your email address."

					div(class="row mb-3")
						label(for="staticEmail" class="col-12 col-form-label") Email
							if !user.email
								span(class="badge badge-pill badge-warning ml-1") !
						p.col-12.text-muted= emailMsg
						div.col-lg-8.mb-2.mb-lg-0
							input(type="text" readonly class="form-control" id="staticEmail" value=emailStatus)
						button(class="btn btn-primary mx-3 mx-lg-0" id="setEmail" data-toggle="modal" data-target="#emailModal")= buttonText
					div(class="row mb-3")
						label(for="inputPassword" class="col-12 col-form-label") Password
						button(class="btn btn-primary mx-3" id="setPassword" data-toggle="modal" data-target="#passwordModal") Change Password
