extends layout

block scripts
  link(href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css" rel="stylesheet")
  script(src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/bootstrap-select.min.js")
  script(src="/javascripts/lazyload.js")

block content
  div.container
    h1.display-1.border-0.text-center.py-2
      img(src="/images/karasu.png" style="width:99px;border:5px solid white;border-radius:50px;box-shadow: rgba(149, 157, 165, 0.2) 0px 8px 24px;")
    div#question.card.card-body.text-center.mb-3(style="border-radius:5rem;box-shadow: rgba(149, 157, 165, 0.2) 0px 8px 24px;")
      form
        if path === "dt_rewards"
          include mixins/ask/dtRewards
        else if path === "card_unlock_items"
          include mixins/ask/cardUnlockItems
        else if path === "majolish_cards"
          include mixins/ask/majolishCards
        else if path === "skill_charge_time"
          include mixins/ask/skillChargeSpeed
        else if path === "skills"
          include mixins/ask/skills
        +question(query)
        div.custom-control.custom-checkbox.custom-control-inline
          input#showOwned.custom-control-input(type="checkbox" name="owned" checked=(user && query.owned === "on") disabled=(!user))
          label.custom-control-label(for="showOwned") Only show cards I own.
        if path !== "skill_charge_time" && path !== "skills"
          div.custom-control.custom-checkbox.custom-control-inline
            input#hideUnlocked.custom-control-input(type="checkbox" name="locked" checked=(user && query.locked === "on") disabled=(!user))
            label.custom-control-label(for="hideUnlocked") Hide nodes I've already unlocked.
    p.text-center.text-muted If you like this feature, please share it with others! We will add more questions only if people are interested.

    if path === "skill_charge_time"
      p.small.text-center.text-muted *Only SSR and above is displayed.
      div.d-flex.flex-wrap.justify-content-center
        each i in cards
          a(href="/card/" + getURL(i.name)): img.lazy.m-2(src="/images/reward_placeholder.png" data-src="/images/cards/S/" + i.uniqueName + ".jpg" style="width:110px;")
    else if path === "skills"
      div.d-flex.flex-wrap.justify-content-around
        each i in cards
          div.card.mb-3(style="max-width: 540px;")
            div.row.no-gutters
              div.col-4
                a(href="/card/" + i.uniqueName)
                  img.img-fluid.lazy(src="/images/card_placeholder.jpg" data-src="/images/cards/L/" + i.uniqueName + ".jpg" alt=i.uniqueName + ".jpg")
              div.col-8
                div.card-body
                  p.card-text: a.stretched-link(href="/card/" + i.uniqueName)= t("lang") === "ja" ? i.ja_name : i.name
                  p.card-text
                    small.text-muted= i.skills.skillType
                    br
                    | #{i.skills.title}
                  p.card-text= i.skills.description
    else
      div.d-flex.flex-wrap.justify-content-around
        each i in cards
          div.card.mb-3(style="max-width: 540px;")
            div.row.no-gutters
              div.col-4
                a(href="/card/" + i.uniqueName)
                  img.img-fluid.lazy(src="/images/card_placeholder.jpg" data-src="/images/cards/L/" + i.uniqueName + ".jpg" alt=i.uniqueName + ".jpg")
              div.col-8
                div.card-body
                  p.card-text: a.stretched-link(href="/card/" + i.uniqueName)= t("lang") === "ja" ? i.ja_name : i.name
                  p.card-text.mb-0.mb-md-3 #{i.dt.reward}
                    if i.dt.type === "item"
                      |
                      | x#{i.dt.count?i.dt.count.toLocaleString("en"):"???"}
                  if i.dt.requirements && i.dt.requirements.length > 0
                    ul.d-none.d-md-block
                      each j in i.dt.requirements
                        li #{j.name ? j.name : "???"} x#{j.amount ? j.amount.toLocaleString("en") : "???" }
                  else
                    p.card-text.d-none.d-md-block Requirements ???
                  p.card-text.d-none.d-md-block Grimm: #{i.dt.grimmCost ? i.dt.grimmCost.toLocaleString("en") : "???"}

  script.
    $(function() {
      $('#select-picker').selectpicker({
        liveSearch: true,
        style: '',
        styleBase: 'form-control mb-0',
        title: '--'
      });
    });
  style.
    .bootstrap-select > .dropdown-menu {
        box-shadow: rgba(149, 157, 165, 0.2) 0px 8px 24px;
    }
    @media (max-width: 540px) {
      #question {
        padding: 2rem;
      }
    }
